<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <title>GreenRide</title>
    <meta charset="UTF-8">
    <style>
        /* ============================
           1. CSS VARIABLES
           ============================ */
        :root {
            --bg-color: #f0f2f5; --card-bg: #ffffff; --text-color: #333333;
            --text-secondary: #666666; --header-bg: rgba(255, 255, 255, 0.85);
            --accent-color: #2e7d32; --border-color: #eeeeee;
            --grid-line: rgba(0, 0, 0, 0.04); --shadow-color: rgba(0,0,0,0.05);
            --input-bg: #f9fafb; --nav-hover: #f5f5f5;
        }
        body.dark-theme {
            --bg-color: #0a0a0a; --card-bg: #18181b; --text-color: #ededed;
            --text-secondary: #a1a1aa; --header-bg: rgba(24, 24, 27, 0.85);
            --accent-color: #4ade80; --border-color: #27272a;
            --grid-line: rgba(74, 222, 128, 0.15); --shadow-color: rgba(0,0,0,0.3);
            --input-bg: #27272a; --nav-hover: #27272a;
        }

        body { font-family: 'Inter', sans-serif; margin: 0; padding: 0; background-color: var(--bg-color); color: var(--text-color); transition: background 0.4s, color 0.4s; overflow-x: hidden; min-height: 100vh; }

        .background-container { position: fixed; inset: 0; z-index: -1; background-image: linear-gradient(var(--grid-line) 1px, transparent 1px), linear-gradient(90deg, var(--grid-line) 1px, transparent 1px); background-size: 50px 50px; perspective: 500px; animation: moveGrid 60s linear infinite; }
        @keyframes moveGrid { 0% { transform: translateY(0) scale(1.05); } 50% { transform: translateY(-25px) scale(1); } 100% { transform: translateY(0) scale(1.05); } }

        /* Buttons & Utils */
        .btn { padding: 12px 20px; border-radius: 8px; font-weight: 600; color: white; display: inline-flex; align-items: center; justify-content: center; cursor: pointer; border: none; transition: all 0.2s; box-sizing: border-box; text-decoration: none; width: 100%;}
        .btn:hover { transform: translateY(-2px); }
        .btn-theme { background: transparent; border: 1px solid var(--border-color); color: var(--text-color); width: 40px; height: 40px; border-radius: 50%; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; cursor: pointer;}
        .gradient-text { background: linear-gradient(135deg, var(--accent-color) 0%, #3b82f6 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; }

        /* ============================
           2. SEARCH BAR STYLES
           ============================ */
        .search-container {
            width: 100%; max-width: 800px; margin-bottom: 30px;
            background: var(--card-bg); padding: 10px; border-radius: 12px;
            border: 1px solid var(--border-color); box-shadow: 0 4px 20px var(--shadow-color);
            display: flex; gap: 10px; align-items: center;
        }
        .search-input {
            flex: 1; padding: 12px; border: 1px solid var(--border-color);
            background: var(--input-bg); border-radius: 8px; color: var(--text-color); font-family: inherit; font-size: 1rem;
        }
        .search-btn {
            background: var(--accent-color); color: white; padding: 12px 25px;
            border: none; border-radius: 8px; font-weight: bold; cursor: pointer;
            transition: transform 0.2s; white-space: nowrap;
        }
        .search-btn:hover { transform: translateY(-2px); }

        @media (max-width: 600px) {
            .search-container { flex-direction: column; }
            .search-btn { width: 100%; }
        }

        /* ============================
           3. FAQ / HOW IT WORKS SECTION
           ============================ */
        .faq-section {
            width: 100%; max-width: 800px; margin: 80px auto 40px;
            padding: 0 20px; box-sizing: border-box;
            animation: fadeInUp 1s forwards;
        }
        .faq-title {
            text-align: center; font-size: 2.5rem; margin-bottom: 40px;
            background: linear-gradient(135deg, var(--accent-color) 0%, #3b82f6 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .faq-item {
            background: var(--card-bg); border: 1px solid var(--border-color);
            margin-bottom: 15px; border-radius: 12px; overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px var(--shadow-color);
        }
        .faq-item:hover { transform: translateY(-2px); box-shadow: 0 10px 15px var(--shadow-color); }
        .faq-question {
            width: 100%; text-align: left; padding: 20px;
            background: none; border: none; outline: none;
            display: flex; justify-content: space-between; align-items: center;
            cursor: pointer; font-size: 1.1rem; font-weight: 600; color: var(--text-color);
            font-family: inherit;
        }
        .faq-arrow { font-size: 0.8rem; color: var(--text-secondary); transition: transform 0.3s ease; }
        .faq-answer {
            max-height: 0; overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0, 1, 0, 1);
            background: var(--nav-hover);
        }
        .faq-answer p { padding: 20px; margin: 0; color: var(--text-secondary); line-height: 1.6; }
        .faq-item.active { border-color: var(--accent-color); }
        .faq-item.active .faq-arrow { transform: rotate(180deg); color: var(--accent-color); }
        .faq-item.active .faq-answer { max-height: 200px; }

        /* ============================
           4. GUEST VIEW STYLES
           ============================ */
        .guest-container { display: flex; flex-direction: column; align-items: center; padding-top: 8vh; padding-bottom: 50px; }
        .guest-title { font-size: 5rem; margin: 0 0 30px 0; text-align: center; }
        .login-card {
            background: var(--card-bg); padding: 40px; border-radius: 16px; width: 100%; max-width: 380px;
            text-align: center; border: 1px solid var(--border-color); box-shadow: 0 10px 25px var(--shadow-color);
            animation: fadeInUp 0.8s forwards;
        }
        .login-card input { width: 100%; padding: 12px; margin: 10px 0; background: var(--input-bg); border: 1px solid var(--border-color); color: var(--text-color); border-radius: 8px; box-sizing: border-box;}

        .btn-login { background: var(--accent-color); margin-top: 10px; }
        .btn-register { background-color: #52525b; margin-top: 10px; }

        .scroll-text-section { text-align: center; padding: 60px 20px; margin-top: 50px; opacity: 0.1; filter: blur(10px); transition: 1s; transform: translateY(20px);}
        .scroll-text-section.revealed { opacity: 1; filter: blur(0); transform: translateY(0); }
        .scroll-text-section h2 { font-size: 3rem; margin-bottom: 20px; }

        /* ============================
           5. USER VIEW STYLES (Hybrid Layout)
           ============================ */
        .app-header {
            position: fixed; top: 0; left: 0; right: 0; height: 70px;
            background: var(--header-bg); backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-color);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 30px; z-index: 100;
        }
        .app-logo { font-size: 1.5rem; text-decoration: none; }

        .nav-controls { display: flex; align-items: center; gap: 15px; position: relative; }
        .hamburger-btn { background: none; border: none; color: var(--text-color); font-size: 1.8rem; cursor: pointer; padding: 5px; }

        .dropdown-menu {
            position: absolute; top: 60px; right: 0; width: 220px;
            background: var(--card-bg); border: 1px solid var(--border-color);
            border-radius: 12px; box-shadow: 0 10px 30px var(--shadow-color);
            display: none; flex-direction: column; overflow: hidden;
            opacity: 0; transform: translateY(-10px); transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .dropdown-menu.active { display: flex; opacity: 1; transform: translateY(0); }
        .dropdown-item {
            padding: 15px 20px; text-decoration: none; color: var(--text-color); font-weight: 500;
            display: flex; align-items: center; gap: 10px; transition: background 0.2s;
            border-bottom: 1px solid var(--border-color);
        }
        .dropdown-item:last-child { border-bottom: none; }
        .dropdown-item:hover { background: var(--nav-hover); color: var(--accent-color); }

        /* HYBRID LAYOUT: Center top items, Full width Grid */
        .app-container {
            margin-top: 100px; display: flex; flex-direction: column;
            align-items: center;
            padding-bottom: 50px; width: 100%;
        }

        .action-bar { width: 100%; max-width: 800px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .btn-create { background: linear-gradient(135deg, #f97316 0%, #ea580c 100%); box-shadow: 0 4px 15px rgba(234, 88, 12, 0.3); width: auto; }

        /* GRID: Full Width, Edge to Edge */
        .route-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            width: 100%; max-width: 100%; /* Full width */
            padding: 0 40px; box-sizing: border-box; /* Side Padding */
        }

        .route-card {
            background: var(--card-bg); padding: 25px; border-radius: 16px;
            border: 1px solid var(--border-color); border-left: 5px solid var(--accent-color);
            box-shadow: 0 4px 10px var(--shadow-color); transition: all 0.3s ease;
            animation: fadeInUp 0.5s forwards; opacity: 0; transform: translateY(20px);
            display: flex; flex-direction: column;
        }
        .route-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px var(--shadow-color); }

        /* TOAST NOTIFICATION */
        .toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .toast { background: var(--card-bg); color: var(--text-color); border-left: 5px solid var(--accent-color); padding: 15px 20px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); width: 300px; display: flex; align-items: center; gap: 10px; animation: slideInRight 0.5s, fadeOut 0.5s 4.5s forwards; }
        @keyframes slideInRight { from { transform: translateX(100%); } to { transform: translateX(0); } }
        @keyframes fadeOut { to { opacity: 0; pointer-events: none; } }

        .route-info { margin: 8px 0; color: var(--text-secondary); display: flex; align-items: center; gap: 8px; font-size: 0.95rem; }
        .badge { background: rgba(46, 125, 50, 0.1); color: var(--accent-color); padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; white-space: nowrap; }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="background-container"></div>

<th:block sec:authorize="!isAuthenticated()">
    <div style="position: absolute; top: 20px; right: 20px;">
        <button id="theme-toggle-guest" class="btn-theme" onclick="toggleTheme()">üåô</button>
    </div>

    <div class="guest-container">
        <h1 class="guest-title"><span class="gradient-text">GreenRide</span></h1>

        <div class="login-card">
            <h3 style="margin: 0 0 20px 0; color: var(--text-color); opacity: 0.8;">Welcome Back</h3>
            <form th:action="@{/login}" method="post">
                <input type="text" name="username" placeholder="Username" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit" class="btn btn-login">Log In</button>
            </form>
            <a href="/register" class="btn btn-register">Create Account</a>
        </div>

        <div class="scroll-text-section js-scroll">
            <h2>Sustainable travel,<br>simplified.</h2>
            <p style="font-size: 1.2rem; color: var(--text-secondary);">Join the movement today.</p>
        </div>

        <form action="/" method="get" class="search-container">
            <input type="text" name="from" class="search-input" placeholder="From (City)" th:value="${searchFrom}">
            <span style="color: var(--text-secondary);">‚ûî</span>
            <input type="text" name="to" class="search-input" placeholder="To (City)" th:value="${searchTo}">
            <button type="submit" class="search-btn">üîç Search</button>
            <a href="/" th:if="${searchFrom != null}" style="color: var(--text-secondary); text-decoration: none; padding: 0 10px; font-weight: bold;">‚úï</a>
        </form>

        <div style="margin-top: 30px; width: 100%; max-width: 800px; padding: 0 20px;">
            <h3 style="color: var(--text-secondary); margin-bottom: 20px;">Recent Activity</h3>
            <div class="route-grid">
                <div th:each="route : ${routes}" class="route-card">
                    <h3 th:text="${route.startAddress} + ' ‚ûî ' + ${route.destinationAddress}">City A to City B</h3>
                    <div class="route-info">Login to view details</div>
                </div>
            </div>
        </div>

        <div class="faq-section">
            <h2 class="faq-title">How GreenRide Works</h2>
            <div class="faq-item">
                <button class="faq-question"><span>üöó How do I book a ride?</span><span class="faq-arrow">‚ñº</span></button>
                <div class="faq-answer"><p>Simply browse the available rides above, click "View & Book", and confirm your details.</p></div>
            </div>
            <div class="faq-item">
                <button class="faq-question"><span>‚≠ê How does rating work?</span><span class="faq-arrow">‚ñº</span></button>
                <div class="faq-answer"><p>After a ride finishes, you will be prompted to rate your driver and fellow passengers.</p></div>
            </div>
        </div>
    </div>
</th:block>


<th:block sec:authorize="isAuthenticated()">

    <header class="app-header">
        <a href="/" class="app-logo gradient-text">GreenRide</a>

        <div class="nav-controls">
            <button id="theme-toggle-user" class="btn-theme" onclick="toggleTheme()">üåô</button>
            <a href="/notifications" class="btn-theme" style="text-decoration: none; display: flex; align-items: center; justify-content: center;">üîî</a>
            <button class="hamburger-btn" onclick="toggleMenu()">‚ò∞</button>

            <div id="dropdown-menu" class="dropdown-menu">
                <div style="padding: 15px 20px; background: var(--bg-color); border-bottom: 1px solid var(--border-color);">
                    <small style="color: var(--text-secondary);">Signed in as</small><br>
                    <b style="color: var(--text-color);" sec:authentication="name">User</b>
                </div>
                <a href="/" class="dropdown-item">üè† Home</a>
                <a href="/my-account" class="dropdown-item">üë§ My Account</a>
                <a href="/my-routes" class="dropdown-item">üìç My Routes</a>
                <form th:action="@{/logout}" method="post" style="margin: 0;">
                    <button type="submit" class="dropdown-item"
                            style="width: 100%; text-align: left; background: none; border: none; cursor: pointer; color: #ef4444; font-family: inherit; font-size: inherit;">
                        üö™ Logout
                    </button>
                </form>
            </div>
        </div>
    </header>

    <div class="app-container">

        <div class="action-bar">
            <h2 style="margin: 0; font-size: 44px; color: var(--text-color);">Available Rides</h2>
            <a href="/create-route" class="btn btn-create">+ Post Route</a>
        </div>

        <form action="/" method="get" class="search-container">
            <input type="text" name="from" class="search-input" placeholder="From (City)" th:value="${searchFrom}">
            <span style="color: var(--text-secondary);">‚ûî</span>
            <input type="text" name="to" class="search-input" placeholder="To (City)" th:value="${searchTo}">
            <button type="submit" class="search-btn">üîç Search</button>
            <a href="/" th:if="${searchFrom != null}" style="color: var(--text-secondary); text-decoration: none; padding: 0 10px; font-weight: bold;">‚úï</a>
        </form>

        <div th:if="${routes.isEmpty()}" style="text-align: center; color: var(--text-secondary); margin-top: 50px;">
            <h2>üì≠</h2>
            <p>No rides available right now.</p>
        </div>

        <div class="route-grid">
            <div th:each="route : ${routes}" class="route-card">
                <a th:href="@{/route/{id}(id=${route.id})}" style="text-decoration: none; color: inherit; display: block;">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <h3 style="margin: 0; color: var(--text-color); cursor: pointer;"
                            th:text="${route.startAddress} + ' ‚ûî ' + ${route.destinationAddress}">A to B</h3>
                        <span class="badge" th:text="${route.status}" style="flex-shrink: 0;">CREATED</span>
                    </div>
                </a>

                <hr style="border: 0; border-top: 1px solid var(--border-color); margin: 15px 0; width: 100%;">

                <div class="route-info">
                    <span style="min-width: 20px;">Driver :</span>
                    <a th:href="@{/user/{u}(u=${route.driver.username})}"
                       style="color: var(--text-color); text-decoration: none; font-weight: bold; border-bottom: 1px dotted var(--text-secondary);">
                        <span th:text="${route.driver.username}">Driver</span>
                    </a>
                </div>
                <div class="route-info car-brand-row">
                    <img class="brand-logo" src="" alt="" style="width: 24px; height: 24px; object-fit: contain; margin-right: 8px; display: none;">
                    <span class="brand-fallback" style="margin-right: 5px;">üöò</span>
                    <strong class="car-model-name" th:text="${route.carModel}">Car Model</strong>
                </div>
                <div class="route-info"><span>Date: </span> <span th:text="${#temporals.format(route.departureTime, 'dd MMM, HH:mm')}">Date</span></div>
                <div class="route-info"><span>Number of Seats: </span> <span th:text="${route.availableSeats}">3</span> seats</div>
                <div class="route-info"><span>Price: </span> $<span th:text="${route.price}">10.0</span></div>

                <div style="margin-top: auto; padding-top: 20px; display: flex; flex-direction: column; gap: 10px;">
                    <div th:if="${bookedRouteIds.contains(route.id)}" style="text-align: center; padding: 10px; background: rgba(46, 125, 50, 0.1); border: 1px solid var(--accent-color); border-radius: 8px; color: var(--accent-color); font-weight: 700;">‚úÖ BOOKED</div>
                    <div th:if="${#authentication.name == route.driver.username}" style="color: var(--accent-color); font-weight: bold; text-align: center; border: 1px solid var(--accent-color); padding: 10px; border-radius: 8px;">‚úÖ Your Ride</div>

                    <a th:if="${!bookedRouteIds.contains(route.id) and #authentication.name != route.driver.username and route.availableSeats > 0}" th:href="@{/route/{id}(id=${route.id})}" class="btn" style="background-color: var(--accent-color); text-decoration: none;">View & Book</a>
                    <a th:if="${bookedRouteIds.contains(route.id) or #authentication.name == route.driver.username or route.availableSeats == 0}" th:href="@{/route/{id}(id=${route.id})}" class="btn" style="background-color: transparent; border: 1px solid var(--border-color); color: var(--text-color); text-align: center; text-decoration: none;">View Map & Details</a>
                </div>
            </div>
        </div>

        <div class="faq-section">
            <h2 class="faq-title">How GreenRide Works</h2>
            <div class="faq-item">
                <button class="faq-question"><span>üöó How do I book a ride?</span><span class="faq-arrow">‚ñº</span></button>
                <div class="faq-answer"><p>Browse rides, click "View & Book", and confirm. Payment is secure.</p></div>
            </div>
            <div class="faq-item">
                <button class="faq-question"><span>‚≠ê How does the rating system work?</span><span class="faq-arrow">‚ñº</span></button>
                <div class="faq-answer"><p>Rate drivers and passengers after the ride to build community trust.</p></div>
            </div>
            <div class="faq-item">
                <button class="faq-question"><span>‚ùå Can I cancel a booking?</span><span class="faq-arrow">‚ñº</span></button>
                <div class="faq-answer"><p>Yes, from "My Routes". Cancellations < 10 mins before departure are not refunded.</p></div>
            </div>
        </div>

    </div>
</th:block>

<div class="toast-container" id="toastContainer"></div>

<script>
    function applyTheme() {
        const theme = localStorage.getItem('theme');
        const btns = [document.getElementById('theme-toggle-guest'), document.getElementById('theme-toggle-user')];
        if (theme === 'dark') {
            document.body.classList.add('dark-theme');
            btns.forEach(b => { if(b) b.textContent = '‚òÄÔ∏è'; });
        } else {
            btns.forEach(b => { if(b) b.textContent = 'üåô'; });
        }
    }
    function toggleTheme() {
        document.body.classList.toggle('dark-theme');
        let theme = 'light';
        if (document.body.classList.contains('dark-theme')) theme = 'dark';
        localStorage.setItem('theme', theme);
        applyTheme();
    }
    applyTheme();

    function toggleMenu() {
        const menu = document.getElementById('dropdown-menu');
        if (menu.classList.contains('active')) {
            menu.classList.remove('active');
            setTimeout(() => menu.style.display = 'none', 300);
        } else {
            menu.style.display = 'flex';
            setTimeout(() => menu.classList.add('active'), 10);
        }
    }
    window.addEventListener('click', (e) => {
        const menu = document.getElementById('dropdown-menu');
        const btn = document.querySelector('.hamburger-btn');
        if (menu && menu.classList.contains('active') && !menu.contains(e.target) && !btn.contains(e.target)) toggleMenu();
    });

    document.addEventListener("DOMContentLoaded", () => {
        const target = document.querySelector('.js-scroll');
        if(target) {
            window.addEventListener('scroll', () => {
                if(target.getBoundingClientRect().top < window.innerHeight * 0.8) target.classList.add('revealed');
            });
        }
    });

    document.querySelectorAll('.faq-item').forEach(item => {
        item.querySelector('.faq-question').addEventListener('click', () => {
            item.classList.toggle('active');
        });
    });

    setInterval(() => {
        fetch('/api/notifications/unread')
            .then(res => res.json())
            .then(notifs => notifs.forEach(n => showToast(n.message)))
            .catch(err => console.log("Polling error (ignore if logged out)"));
    }, 3000);

    function showToast(msg) {
        const container = document.getElementById('toastContainer');
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.innerHTML = `<span>üîî</span> <div>${msg}</div>`;
        container.appendChild(toast);
        setTimeout(() => { toast.remove(); }, 5000);
    }

    /* =========================================
       ‚úÖ CAR LOGO LOADER
       ========================================= */
    function loadCarLogos() {
        // Mapping of Brands to High-Quality SVGs
        const brandMap = {
            'toyota': 'https://upload.wikimedia.org/wikipedia/commons/9/9d/Toyota_carlogo.svg',
            'bmw': 'https://upload.wikimedia.org/wikipedia/commons/4/44/BMW.svg',
            'mercedes': 'https://upload.wikimedia.org/wikipedia/commons/9/90/Mercedes-Logo.svg',
            'mercedes-benz': 'https://upload.wikimedia.org/wikipedia/commons/9/90/Mercedes-Logo.svg',
            'tesla': 'https://upload.wikimedia.org/wikipedia/commons/b/bd/Tesla_Motors.svg',
            'audi': 'https://upload.wikimedia.org/wikipedia/commons/9/92/Audi-Logo_2016.svg',
            'ford': 'https://upload.wikimedia.org/wikipedia/commons/3/3e/Ford_logo_flat.svg',
            'volkswagen': 'https://upload.wikimedia.org/wikipedia/commons/6/6d/Volkswagen_logo_2019.svg',
            'vw': 'https://upload.wikimedia.org/wikipedia/commons/6/6d/Volkswagen_logo_2019.svg',
            'honda': 'https://upload.wikimedia.org/wikipedia/commons/7/7b/Honda_Logo.svg',
            'hyundai': 'https://upload.wikimedia.org/wikipedia/commons/4/44/Hyundai_Motor_Company_logo.svg',
            'nissan': 'https://upload.wikimedia.org/wikipedia/commons/8/8c/Nissan_logo.png',
            'chevrolet': 'https://upload.wikimedia.org/wikipedia/commons/1/1e/Chevrolet-logo.png',
            'kia': 'https://upload.wikimedia.org/wikipedia/commons/4/47/Kia_logo.svg',
            'peugeot': 'https://upload.wikimedia.org/wikipedia/commons/f/f7/Peugeot_Logo.svg'
        };

        const cards = document.querySelectorAll('.car-brand-row');

        cards.forEach(row => {
            const modelName = row.querySelector('.car-model-name').innerText.trim().toLowerCase();
            const firstWord = modelName.split(' ')[0]; // Extract "Toyota" from "Toyota Yaris"

            const img = row.querySelector('.brand-logo');
            const fallback = row.querySelector('.brand-fallback');

            // Check Hardcoded Map
            if (brandMap[firstWord]) {
                img.src = brandMap[firstWord];
                img.style.display = 'inline-block';
                fallback.style.display = 'none';
            }
            // Fallback to Clearbit API for others (e.g., Porsche, Ferrari)
            else {
                const clearbitUrl = `https://logo.clearbit.com/${firstWord}.com`;
                const tempImg = new Image();
                tempImg.src = clearbitUrl;

                tempImg.onload = function() {
                    img.src = clearbitUrl;
                    img.style.display = 'inline-block';
                    fallback.style.display = 'none';
                };
                // If error, keep the fallback emoji
            }
        });
    }

    // Run after DOM load
    document.addEventListener('DOMContentLoaded', loadCarLogos);

</script>
</body>
</html>